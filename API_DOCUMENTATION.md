# API Documentation

| Orders (Index) | Route | Method | Middlewares | Request | Response |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 1 | /api/auth/register | POST | `upload.single("avatar")`, `requireFields(["name", "email", "password", "phone", "address"])` | **Body:** `name` (string, required), `email` (string, required), `password` (string, required), `phone` (string, required), `address` (string, required), `avatar` (file, optional) | **200 OK:** `{"success": true, "message": "Register successfully. Please check your email for verify", "token": "..."}` |
| 2 | /api/auth/verify | GET | None | **Query:** `token` (string, required) | **201 Created:** `{"success": true, "message": "Your email has been verified successfully"}` |
| 3 | /api/auth/login | POST | `Validation.email`, `Validation.password`, `requireFields(["email", "password"])`, `checkUserStatusByEmail()` | **Body:** `email` (string, required), `password` (string, required) | **200 OK:** `{"success": true, "message": "Login successfully", "accessToken": "...", "refreshToken": "..."}` |
| 4 | /api/auth/refresh-token | GET | `verifyRefreshToken` | **Headers:** `Cookie` (containing `refreshToken`) | **200 OK:** `{"success": true, "message": "New Access Token Created", "accessToken": "..."}` |
| 5 | /api/auth/logout | POST | `credentials`, `verifyRole(["User"])` | None | **200 OK:** `{"success": true, "message": "Log out successfully"}` |
| 6 | /api/auth/login-google | POST | `requireFields(["code"])` | **Body:** `code` (string, required) | **200 OK:** `{"success": true, "accessToken": "...", "refreshToken": "..."}` |
| 7 | /api/user/forgot-password | POST | `credentials`, `requireFields(["email"])`, `checkUserStatusByEmail()` | **Body:** `email` (string, required) | **200 OK:** `{"success": true, "message": "Email has been sent. Check your mailbox", "token": "..."}` |
| 8 | /api/user/reset-password | POST | `credentials`, `requireFields(["email", "token", "password"])`, `Validation.email`, `Validation.password`, `checkUserStatusByEmail()`, `verifyResetPasswordToken` | **Body:** `email` (string, required), `token` (string, required), `password` (string, required) | **200 OK:** `{"success": true, "message": "Password changes successfully"}` |
| 9 | /api/user/profile | GET | `credentials` | None | **200 OK:** `{"success": true, "message": "Profile retrieved successfully.", "data": {"id": 1, "name": "...", "email": "...", "phone": "...", "address": "...", "avatar": "...", "userRoles": [{"userID": 1, "roleID": 1}], "createdAt": "..."}}` |
| 10 | /api/user/update-profile | PATCH | `credentials` | **Body:** `name` (string, optional), `phone` (string, optional), `address` (string, optional) | **200 OK:** `{"success": true, "message": "Profile updated successfully.", "data": {"id": 1, "name": "...", "email": "...", "phone": "...", "address": "...", "avatar": "...", "verify": true, "userRoles": [{"userID": 1, "roleID": 1}], "carts": {"id": 1, "userID": 1}, "orders": []}}` |
| 11 | /api/user/update-avatar | PATCH | `upload.single("avatar")`, `credentials`, `verifyRole(["User"])` | **Body:** `avatar` (file, required) | **200 OK:** `{"success": true, "message": "Avatar updated successfully.", "data": {"avatar": "...", "url": "..."}}` |
| 12 | /api/user/change-email | POST | `credentials`, `verifyRole(["User"])`, `requireFields(["email", "password"])`, `Validation.email`, `Validation.password` | **Body:** `email` (string, required), `password` (string, required) | **200 OK:** `{"success": true, "message": "Email has been sent. Check your mailbox", "token": "..."}` |
| 13 | /api/user/reset-email | POST | `credentials`, `requireFields(["email", "token"])`, `verifyResetEmailToken` | **Body:** `email` (string, required), `token` (string, required) | **200 OK:** `{"success": true, "message": "Email updated successfully"}` |
| 14 | /api/colors | GET | None | None | **200 OK:** `{"success": true, "message": "Get all colors successfully", "data": [{"id": 1, "name": "...", "hex": "..."}, ...]}` |
| 15 | /api/colors/:id | GET | `Validation.numberIDParam` | **Params:** `id` (number, required) | **200 OK:** `{"success": true, "message": "Get color successfully", "data": {"id": 1, "name": "...", "hex": "..."}}` |
| 16 | /api/admin/colors | POST | `credentials`, `verifyRole(["Admin"])` | **Body:** `name` (string, required), `hex` (string, required) | **201 Created:** `{"success": true, "message": "Create color successfully", "colorName": "...", "colorID": 1, "colorHex": "..."}` |
| 17 | /api/admin/colors/:id | PUT | `credentials`, `verifyRole(["Admin"])` | **Params:** `id` (number, required), **Body:** `name` (string, optional), `hex` (string, optional) | **200 OK:** `{"success": true, "message": "Color updated successfully", "data": {"id": 1, "name": "...", "hex": "..."}}` |
| 18 | /api/admin/colors/:id | DELETE | `credentials`, `verifyRole(["Admin"])` | **Params:** `id` (number, required) | **200 OK:** `{"success": true, "message": "Color deleted successfully"}` |
| 19 | /api/brands | GET | None | None | **200 OK:** `{"success": true, "message": "Get all brands successfully", "data": [{"id": 1, "name": "..."}, ...]}` |
| 20 | /api/brands/:id | GET | `Validation.numberIDParam` | **Params:** `id` (number, required) | **200 OK:** `{"success": true, "message": "Get all brands successfully", "data": {"id": 1, "name": "..."}}` |
| 21 | /api/admin/brands | POST | `credentials`, `verifyRole(["Admin"])` | **Body:** `name` (string, required) | **201 Created:** `{"success": true, "message": "Create brand successfully", "brandName": "...", "brandID": 1}` |
| 22 | /api/admin/brands/:id | PUT | `credentials`, `verifyRole(["Admin"])` | **Params:** `id` (number, required), **Body:** `name` (string, required) | **200 OK:** `{"success": true, "message": "Brand updated successfully", "data": {"id": 1, "name": "..."}}` |
| 23 | /api/admin/brands/:id | DELETE | `credentials`, `verifyRole(["Admin"])` | **Params:** `id` (number, required) | **200 OK:** `{"success": true, "message": "Brand deleted successfully"}` |
| 24 | /api/cart/add-product | POST | `credentials`, `verifyRole(["User"])`, `requireFields(["productID"])` | **Body:** `productID` (number, required) | **200 OK:** `{"success": true, "message": "Save product successfully"}` |
| 25 | /api/cart/remove-product/:id | DELETE | `credentials`, `verifyRole(["User"])` | **Params:** `id` (number, required) | **200 OK:** `{"success": true, "message": "Remove product successfully"}` |
| 26 | /api/cart/all-products | GET | `credentials`, `verifyRole(["User"])` | None | **200 OK:** `{"success": true, "data": [{"id": 1, "quantity": 1, "product": {"id": 1, "name": "...", "price": "...", "description": "...", "discount": "...", "category": [...], "thumbnail": "..."}}, ...]}` |
| 27 | /api/cart | POST | `credentials`, `checkUserStatusByID()`, `verifyRole(["Admin"])` | None | **201 Created:** `{"success": true, "message": "Create cart successfully", "cartID": 1}` |
| 28 | /api/cart | DELETE | `credentials`, `checkUserStatusByID()`, `verifyRole(["Admin"])` | None | **200 OK:** `{"success": true, "message": "delete cart successfully"}` |
| 29 | /api/cart | GET | `credentials`, `checkUserStatusByID()` | None | **200 OK:** `{"success": true, "message": "Cart retrieved successfully for the user.", "cartID": 1}` |
| 30 | /api/payment/process | POST | `credentials`, `requireFields(["orderID", "paymentMethod"])` | **Body:** `orderID` (number, required), `paymentMethod` (string, required, "COD" or "credit_card") | **200 OK:** `{"success": true, "message": "Payment via ... recorded successfully.", "data": {"id": 1, "orderID": 1, "paymentMethod": "..."}}` |
| 31 | /api/payment/cancel | DELETE | `credentials`, `requireFields(["orderID"])` | **Body:** `orderID` (number, required) | **200 OK:** `{"success": true, "message": "Payment cancelled successfully. You can now choose a different method."}` |
| 32 | /api/product | GET | None | None | **200 OK:** `{"success": true, "message": "Get all products successfully", "data": [{"id": 1, "name": "...", "description": "...", "price": "...", "active": true, "thumbnail": [{"public_id": "...", "url": "..."}], "discount": "...", "category": [...], "brand": {"id": 1, "name": "..."}, "productVariants": [...]}, ...]}` |
| 33 | /api/product/search | GET | None | **Query:** `query` (string, required) | **200 OK:** `{"success": true, "message": "Search completed successfully", "data": [{"id": 1, "name": "...", "description": "...", "price": "...", "active": true, "thumbnail": [...], "category": [...], "discount": "...", "brand": {...}, "productVariants": [...]}, ...]}` |
| 34 | /api/product/brand/:brandID | GET | `Validation.numberIDParam` | **Params:** `brandID` (number, required) | **200 OK:** `{"success": true, "message": "Get products by brand successfully", "data": [{"id": 1, "name": "...", "description": "...", "price": "...", "active": true, "thumbnail": [...], "brand": {...}, "productVariants": [...]}, ...]}` |
| 35 | /api/product/:id | GET | `Validation.numberIDParam` | **Params:** `id` (number, required) | **200 OK:** `{"success": true, "message": "Get product successfully", "data": {"id": 1, "name": "...", "description": "...", "price": "...", "active": true, "thumbnail": [{"public_id": "...", "url": "..."}], "discount": "...", "category": [...], "brand": {...}, "productVariants": [...]}}` |
| 36 | /api/admin/products | POST | `credentials`, `verifyRole(["Admin"])`, `upload.array("thumbnail")`, `requireFields(["name", "description", "price", "active", "brandID", "category"])` | **Body:** `name` (string, required), `description` (string, required), `price` (number, required), `active` (boolean, required), `brandID` (number, required), `category` (array of strings, required), `discount` (number, optional), `thumbnail` (files, optional) | **201 Created:** `{"success": true, "message": "Product created successfully", "data": {"id": 1, "name": "...", "description": "...", "price": "...", "active": true, "thumbnail": [{"public_id": "...", "url": "..."}], "discount": "...", "category": [...], "brand": {...}}}` |
| 37 | /api/admin/products/:id | PUT | `credentials`, `verifyRole(["Admin"])`, `upload.array("thumbnail")` | **Params:** `id` (number, required), **Body:** `name` (string, optional), `description` (string, optional), `price` (number, optional), `active` (boolean, optional), `brandID` (number, optional), `category` (array of strings, optional), `discount` (number, optional), `remove_public_id` (array of strings, optional) | **200 OK:** `{"success": true, "message": "Product updated successfully", "data": {"id": 1, "name": "...", "description": "...", "price": "...", "active": true, "thumbnail": [{"public_id": "...", "url": "..."}], "discount": "...", "category": [...], "brand": {...}, "productVariants": [...]}}` |
| 38 | /api/admin/products/:id | DELETE | `credentials`, `verifyRole(["Admin"])` | **Params:** `id` (number, required) | **200 OK:** `{"success": true, "message": "Product and its variants deleted successfully"}` |
| 39 | /api/variant | GET | `credentials`, `verifyRole(["User"])` | None | **200 OK:** `{"success": true, "message": "Get all variants successfully", "data": [{"id": 1, "quantity": 1, "product": {"id": 1, "name": "..."}, "size": 1, "color": {"id": 1, "name": "...", "hex": "..."}}, ...]}` |
| 40 | /api/variant/get-by-product/:id | GET | `credentials`, `verifyRole(["User"])` | **Params:** `id` (number, required) | **200 OK:** `{"success": true, "message": "Get variants successfully", "data": [{"id": 1, "quantity": 1, "size": 1, "color": {"id": 1, "name": "...", "hex": "..."}}, ...]}` |
| 41 | /api/variant/get-by-id/:id | GET | `credentials`, `verifyRole(["User"])` | **Params:** `id` (number, required) | **200 OK:** `{"success": true, "message": "Get variant successfully", "data": {"id": 1, "quantity": 1, "product": {"id": 1, "name": "..."}, "size": 1, "color": {"id": 1, "name": "...", "hex": "..."}}}` |
| 42 | /api/admin/variants | POST | `credentials`, `verifyRole(["Admin"])` | **Body:** `productID` (number, required), `size` (number, required), `colorID` (number, required), `quantity` (number, required) OR `variants` (array of objects, required) | **201 Created:** `{"success": true, "message": "Successfully processed ... variant(s). Created ... new variant(s).", "data": [{"id": 1, "quantity": 1, "size": 1, "color": {"id": 1, "name": "...", "hex": "..."}}, ...]}` |
| 43 | /api/admin/variants/:id | PUT | `credentials`, `verifyRole(["Admin"])` | **Params:** `id` (number, required), **Body:** `size` (number, optional), `colorID` (number, optional), `quantity` (number, optional) | **200 OK:** `{"success": true, "message": "Variant updated successfully", "data": {"id": 1, "quantity": 1, "product": {"id": 1, "name": "..."}, "size": 1, "color": {"id": 1, "name": "...", "hex": "..."}}}` |
| 44 | /api/admin/variants/:id | DELETE | `credentials`, `verifyRole(["Admin"])` | **Params:** `id` (number, required) | **200 OK:** `{"success": true, "message": "Variant deleted successfully"}` |
| 45 | /api/order | POST | `credentials`, `checkUserStatusByID()`, `requireFields(["shippingAddress", "paymentMethod", "items"])` | **Body:** `shippingAddress` (string, required), `paymentMethod` (string, required, "COD" or "credit_card"), `items` (array of objects, required) | **201 Created:** `{"success": true, "message": "Order created successfully", "data": {"id": 1, "status": "...", "shippingAddress": "...", "createdAt": "...", "payments": [...], "orderItems": [...]}}` |
| 46 | /api/order | GET | `credentials`, `checkUserStatusByID()` | None | **200 OK:** `{"success": true, "message": "Get orders successfully", "data": [{"id": 1, "status": "...", "shippingAddress": "...", "createdAt": "...", "payments": [...], "orderItems": [...]}, ...]}` |
| 47 | /api/order/:id | GET | `credentials`, `checkUserStatusByID()`, `Validation.numberIDParam` | **Params:** `id` (number, required) | **200 OK:** `{"success": true, "message": "Get order successfully", "data": {"id": 1, "status": "...", "shippingAddress": "...", "createdAt": "...", "user": {...}, "payments": [...], "orderItems": [...]}}` |
| 48 | /api/order/:id/cancel | PUT | `credentials`, `checkUserStatusByID()`, `Validation.numberIDParam` | **Params:** `id` (number, required) | **200 OK:** `{"success": true, "message": "Order cancelled successfully"}` |
| 49 | /api/order/:id/address | PATCH | `credentials`, `checkUserStatusByID()`, `Validation.numberIDParam`, `requireFields(["shippingAddress"])` | **Params:** `id` (number, required), **Body:** `shippingAddress` (string, required) | **200 OK:** `{"success": true, "message": "Shipping address updated successfully", "data": {"id": 1, "shippingAddress": "...", "status": "..."}}` |
| 50 | /api/admin/orders | GET | `credentials`, `verifyRole(["Admin"])` | None | **200 OK:** `{"success": true, "message": "Get all orders successfully", "data": [{"id": 1, "status": "...", "shippingAddress": "...", "createdAt": "...", "user": {...}, "payments": [...], "orderItems": [...]}, ...]}` |
| 51 | /api/admin/orders/:id | GET | `credentials`, `verifyRole(["Admin"])`, `Validation.numberIDParam` | **Params:** `id` (number, required) | **200 OK:** `{"success": true, "message": "Get order successfully", "data": {"id": 1, "status": "...", "shippingAddress": "...", "createdAt": "...", "user": {...}, "payments": [...], "orderItems": [...]}}` |
| 52 | /api/admin/orders/:id/status | PUT | `credentials`, `verifyRole(["Admin"])`, `Validation.numberIDParam`, `requireFields(["status"])` | **Params:** `id` (number, required), **Body:** `status` (string, required) | **200 OK:** `{"success": true, "message": "Order status updated successfully", "data": {"id": 1, "status": "...", "shippingAddress": "...", "createdAt": "..."}}` |
